{
    "builders": [
        {
            "type": "hcloud",
            "token": "{{ user `hcloud_token` }}",
            "server_type": "cx11",
            "source_image": "{{ user `hcloud_base_image` }}",
            "image_name": "consul",
            "ssh_username": "root"
        }
    ],
    "provisioners": [
        {
            "type": "ansible",
            "playbook_file": "{{ template_dir }}/../../ansible/consul-server.yml",
            "ansible_env_vars": ["ANSIBLE_CONFIG={{ template_dir }}/../../ansible/ansible.cfg"],
            "extra_arguments": [
                "--extra-vars", "{'ansible_connection': 'paramiko'}",
                "--diff"
            ]
        }
    ],
    "post-processors": [
        {
            "type": "manifest",
            "output": "consul-manifest.json",
            "strip_path": true
        }
    ],
    "variables": {
        "hcloud_token": null,
        "hcloud_base_image": null
    }
}
